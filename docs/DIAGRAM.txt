════════════════════════════════════════════════════════════════════════════════
                    BOOKS TO SCRAPE - ARQUITETURA DO SISTEMA
════════════════════════════════════════════════════════════════════════════════

┌──────────────────────────────────────────────────────────────────────────────┐
│                          1. CAMADA DE EXTRAÇÃO (ETL)                          │
└──────────────────────────────────────────────────────────────────────────────┘

    ┌─────────────────────────────────┐
    │   books.toscrape.com            │
    │   (Fonte de Dados)              │
    └────────────┬────────────────────┘
                 │ HTTP GET
                 │
                 ▼
    ┌─────────────────────────────────┐
    │   Python Web Scraper            │
    │   ─────────────────────         │
    │   • BeautifulSoup4              │
    │   • Requests + Retry Logic      │
    │   • Rate Limiting (0.5s)        │
    │   • Error Handling              │
    │   • Logging (logs/scraper.log)  │
    └────────────┬────────────────────┘
                 │ Parse & Transform
                 │
                 ▼
    ┌─────────────────────────────────┐
    │   CSV Storage                   │
    │   ─────────────                 │
    │   data/books.csv                │
    │   • 1000+ registros             │
    │   • 12 campos por livro         │
    │   • Schema validado             │
    └────────────┬────────────────────┘


┌──────────────────────────────────────────────────────────────────────────────┐
│                        2. CAMADA DE APLICAÇÃO (API)                           │
└──────────────────────────────────────────────────────────────────────────────┘

                 │
                 ▼
    ┌─────────────────────────────────┐
    │   FastAPI Application           │
    │   ──────────────────            │
    │   • Uvicorn ASGI Server         │
    │   • Pydantic Validation         │
    │   • CORS Middleware             │
    │   • OpenAPI/Swagger Docs        │
    └────────────┬────────────────────┘
                 │
                 ├──────────────────────────────────────────────┐
                 │                                              │
                 ▼                                              ▼
    ┌────────────────────────┐                    ┌────────────────────────┐
    │   In-Memory Cache      │                    │   Redis Cache          │
    │   (Pandas DataFrame)   │                    │   (Opcional)           │
    │   • Fast reads         │                    │   • TTL: 5-15 min      │
    │   • O(1) lookups       │                    │   • Distributed        │
    └────────────────────────┘                    └────────────────────────┘


┌──────────────────────────────────────────────────────────────────────────────┐
│                         3. ENDPOINTS DA API REST                              │
└──────────────────────────────────────────────────────────────────────────────┘

    ┌─────────────────────────────────────────────────────────────────────────┐
    │  GET /                     → Info da API                                 │
    │  GET /health               → Health check                                │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  GET /books                → Lista paginada (filtros, ordenação)         │
    │  GET /books/{id}           → Detalhes de um livro                        │
    │  GET /books/search?q=...   → Busca por termo                             │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  GET /books/genres         → Lista de categorias                         │
    │  GET /books/genre/{genre}  → Livros por categoria                        │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  GET /stats                → Estatísticas agregadas                      │
    │  GET /ml/sample            → Amostra para ML                             │
    └─────────────────────────────────────────────────────────────────────────┘


┌──────────────────────────────────────────────────────────────────────────────┐
│                          4. CAMADA DE CONSUMO                                 │
└──────────────────────────────────────────────────────────────────────────────┘

                 │
                 ├──────────────────┬──────────────────┬──────────────────┐
                 │                  │                  │                  │
                 ▼                  ▼                  ▼                  ▼
    ┌──────────────────┐  ┌──────────────────┐  ┌──────────────┐  ┌──────────────┐
    │   Web Apps       │  │  Data Science    │  │   ML Models  │  │  Dashboards  │
    │   ────────       │  │  ──────────      │  │  ─────────   │  │  ──────────  │
    │   • React        │  │  • Jupyter       │  │  • Training  │  │  • Grafana   │
    │   • Vue.js       │  │  • Pandas        │  │  • Inference │  │  • Tableau   │
    │   • Angular      │  │  • Analysis      │  │  • AutoML    │  │  • PowerBI   │
    └──────────────────┘  └──────────────────┘  └──────────────┘  └──────────────┘


════════════════════════════════════════════════════════════════════════════════
                             FLUXO DE DADOS DETALHADO
════════════════════════════════════════════════════════════════════════════════

┌─────────┐      ┌──────────┐      ┌─────────┐      ┌─────────┐      ┌─────────┐
│ Source  │─────▶│ Scraper  │─────▶│   CSV   │─────▶│   API   │─────▶│ Clients │
│  Web    │ HTTP │ BeautifulSoup   │  Data   │ Load │ FastAPI │ JSON │  Apps   │
└─────────┘      └──────────┘      └─────────┘      └─────────┘      └─────────┘
   │                  │                  │                │                │
   │                  │                  │                │                │
   ▼                  ▼                  ▼                ▼                ▼
HTML Pages      Parse & Clean     Structured      REST API        Consumption
50 categories   Retry on error    12 fields       10+ endpoints   Multiple use cases
1000+ books     Rate limiting     CSV format      Pagination      Analytics/ML


════════════════════════════════════════════════════════════════════════════════
                          TECNOLOGIAS POR CAMADA
════════════════════════════════════════════════════════════════════════════════

┌───────────────────────┬────────────────────────────────────────────────────┐
│ CAMADA                │ TECNOLOGIA                                         │
├───────────────────────┼────────────────────────────────────────────────────┤
│ Web Scraping          │ Python 3.11, BeautifulSoup4, Requests, lxml       │
│ Data Storage          │ CSV (Pandas), PostgreSQL (futuro)                 │
│ API Framework         │ FastAPI 0.104, Uvicorn, Pydantic                  │
│ Cache                 │ Redis 7 (opcional), In-memory DataFrame           │
│ Testing               │ Pytest, Coverage, HTTPx                            │
│ CI/CD                 │ GitHub Actions, Docker                             │
│ Deploy                │ Render, Heroku, Fly.io, Railway                   │
│ Monitoring            │ Logs, Health checks, Metrics (futuro)             │
└───────────────────────┴────────────────────────────────────────────────────┘


════════════════════════════════════════════════════════════════════════════════
                         ESTRATÉGIAS DE ESCALABILIDADE
════════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│  HORIZONTAL SCALING                                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌─────────────┐                                                           │
│   │Load Balancer│                                                           │
│   │  (Nginx)    │                                                           │
│   └──────┬──────┘                                                           │
│          │                                                                   │
│   ┌──────┴──────┬──────────┬──────────┐                                    │
│   │             │          │          │                                     │
│   ▼             ▼          ▼          ▼                                     │
│ ┌─────┐     ┌─────┐    ┌─────┐    ┌─────┐                                 │
│ │ API │     │ API │    │ API │    │ API │                                  │
│ │  1  │     │  2  │    │  3  │    │  N  │                                  │
│ └─────┘     └─────┘    └─────┘    └─────┘                                 │
│   │             │          │          │                                     │
│   └──────┬──────┴──────────┴──────────┘                                    │
│          │                                                                   │
│          ▼                                                                   │
│   ┌──────────────┐      ┌───────────┐                                      │
│   │  PostgreSQL  │      │   Redis   │                                       │
│   │  (Master)    │      │  Cluster  │                                       │
│   └──────┬───────┘      └───────────┘                                      │
│          │                                                                   │
│   ┌──────┴───────┐                                                          │
│   │              │                                                           │
│   ▼              ▼                                                           │
│ ┌─────┐      ┌─────┐                                                        │
│ │Slave│      │Slave│                                                        │
│ │ DB  │      │ DB  │                                                         │
│ └─────┘      └─────┘                                                        │
└─────────────────────────────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────────┐
│  ASYNC PROCESSING                                                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌──────────┐      ┌─────────────┐      ┌───────────────┐                │
│   │ Trigger  │─────▶│  RabbitMQ   │─────▶│ Celery Worker │                │
│   │ (Cron)   │ Push │   Queue     │ Pull │    Pool       │                │
│   └──────────┘      └─────────────┘      └───────┬───────┘                │
│                                                    │                         │
│                                                    │ Write                   │
│                                                    ▼                         │
│                                              ┌──────────┐                    │
│                                              │ Database │                    │
│                                              └──────────┘                    │
└─────────────────────────────────────────────────────────────────────────────┘


════════════════════════════════════════════════════════════════════════════════
                         INTEGRAÇÃO COM MACHINE LEARNING
════════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│   ┌────────────┐                                                            │
│   │  Books API │                                                            │
│   └──────┬─────┘                                                            │
│          │                                                                   │
│   ┌──────┴────────────────────────────┐                                    │
│   │                                   │                                     │
│   ▼                                   ▼                                     │
│ ┌─────────────────┐          ┌──────────────────┐                          │
│ │ GET /ml/sample  │          │ GET /stats       │                          │
│ │ (Training Data) │          │ (Features)       │                          │
│ └────────┬────────┘          └────────┬─────────┘                          │
│          │                            │                                     │
│          └──────────┬─────────────────┘                                    │
│                     │                                                        │
│                     ▼                                                        │
│            ┌─────────────────┐                                              │
│            │  ML Pipeline    │                                              │
│            ├─────────────────┤                                              │
│            │ • Feature Eng   │                                              │
│            │ • Training      │                                              │
│            │ • Validation    │                                              │
│            │ • Deploy        │                                              │
│            └────────┬────────┘                                              │
│                     │                                                        │
│                     ▼                                                        │
│            ┌─────────────────┐                                              │
│            │  ML Models      │                                              │
│            ├─────────────────┤                                              │
│            │ • Price Predict │                                              │
│            │ • Rating Class  │                                              │
│            │ • Clustering    │                                              │
│            └────────┬────────┘                                              │
│                     │                                                        │
│                     ▼                                                        │
│            ┌─────────────────┐                                              │
│            │ POST /predict   │                                              │
│            │ (Inference API) │                                              │
│            └─────────────────┘                                              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘


════════════════════════════════════════════════════════════════════════════════
                               MONITORAMENTO
════════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│   ┌──────────┐   ┌──────────┐   ┌──────────┐   ┌──────────┐               │
│   │   API    │   │   API    │   │   API    │   │   API    │               │
│   │ Instance │   │ Instance │   │ Instance │   │ Instance │               │
│   └────┬─────┘   └────┬─────┘   └────┬─────┘   └────┬─────┘               │
│        │              │              │              │                       │
│        └──────────────┴──────────────┴──────────────┘                      │
│                       │                                                      │
│                       │ Metrics, Logs, Traces                               │
│                       │                                                      │
│        ┌──────────────┼──────────────┬──────────────┐                      │
│        │              │              │              │                       │
│        ▼              ▼              ▼              ▼                       │
│   ┌─────────┐   ┌──────────┐   ┌─────────┐   ┌─────────┐                 │
│   │ Logging │   │Prometheus│   │  Sentry │   │ DataDog │                 │
│   │  (ELK)  │   │ +Grafana │   │ (Errors)│   │  (APM)  │                 │
│   └─────────┘   └──────────┘   └─────────┘   └─────────┘                 │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘


════════════════════════════════════════════════════════════════════════════════
                                  FIM
════════════════════════════════════════════════════════════════════════════════

